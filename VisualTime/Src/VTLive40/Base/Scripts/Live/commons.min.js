const handleShrinkExpandCommTree=()=>{const n=$("#divTree");n.css("display")=="none"?(n.show(),$(".btnMinimize2").removeClass("btnMinimize2").addClass("btnMaximize2")):(n.hide(),$(".btnMaximize2").removeClass("btnMaximize2").addClass("btnMinimize2"))},toggleHasChanges=n=>{const t=$("#saveBar");n?t.show():t.hide()};window.MaxMinimize=handleShrinkExpandCommTree;window.hasChanges=toggleHasChanges;var viewUtilsManager=function(){function vi(n){let t=n.NAME;return t.length>2?t.substring(2):t}function yi(n,t,i){switch(i){case"DateBoxTime":switch(t.option("type")){case"datetime":case"date":t.option("value",n);break;case"time":t.option("value",k(n.Hours,n.Minutes,!1));break;default:t.option("value",k(n.Hours,n.Minutes,!1))}break;case"FromMinutesToHours":t.option("value",vt(n,!1));break;case"FromMinutesToHoursMask":t.option("value",vt(n,!0));break;default:t.option("value",n)}}async function hr(n,t){if(isNaN(e)||!isNaN(e)&&e!=n){n===undefined&&(n=0);let i=$("#divScreenTabsGeneric .switchMainViewTabsGeneric"),r=$("#divContenido .ro-tab-section");$(i).children(".mainActionBtnGeneric").removeClass("activeTab");$(i).children(".mainActionBtnGeneric[data-tabIntex='"+n+"']").addClass("activeTab");r.children(".ro-tab-pane").removeClass("active");r.children(".ro-tab-pane[data-tabIndex='"+n+"']").addClass("active");typeof t=="function"&&(s=t);s!=null&&await s(n);e=n}}function k(n,t,i){return(n||(n=""),t||(t=""),n=(n+"").padStart(2,"0"),t=(t+"").padStart(2,"0"),i)?`${n}:${t}:00`:`01/01/1990 ${n}:${t}:00`}function vt(n,t){return k(Math.round(n/60),n%60,t)}const h="TEXT NOT FOUND",yt="NO DATA",c=400,pt=180,wt=400,bt=180,kt="bt",l="tx",dt="cl",gt="rg",ni="ck",ti="ta",ii="cb",ri="dg",ui="tb",u="dt",fi="fm",d="#divScreenTabsGeneric .rigthTabButtons";let g=null,f=!1,nt=!1,o=null,tt=null,i=[],r={},a=null,v=!1,e=NaN,s=null,it=async function(n,t,i,r,u,f,e,o,s){let h=null,c=null;try{u!==null&&u();let o={url:`${BASE_URL}`+n+"/"+t,data:r,type:i,success:function(n){h=n;f!==null&&f(h)},error:function(n){c=n;e!==null&&e(c)}};s!="text"&&(o.dataType=s);await $.ajax(o)}catch(l){e!==null&&e(l)}finally{o!==null&&o()}return h},y=async function(n,t,i,r,u,f,e,o){return it(n,t,i,r,u,f,e,o,"json")},ei=async function(n,t,i,r,u,f,e,o){return it(n,t,i,r,u,f,e,o,"script")},oi=function(){let n=document.querySelector(".dxcvCSD > #CardView_DXMainTable > tbody > tr > td.CardsTree-cardClicked .cardsTree-CardInfo");return n?parseInt(n.getAttribute("data-card-id"),10):0},si=function(){let n=document.querySelector(".dxcvCSD > #CardView_DXMainTable > tbody > tr > td.CardsTree-cardClicked .cardsTree-CardInfo");return n?parseInt(n.getAttribute("data-card-issystem")):0},hi=function(n){let i=".dxcvCSD > #CardView_DXMainTable > tbody > tr",t=null;n!=undefined&&n!=null&&(i+=" [data-card-id = '"+n+"']");t=$(i).first();t!=null&&$(t).click()},ci=n=>{let t=n&&n!=""?n:".accordion";$(t).on("click",n=>{n.target.classList.toggle("active");let t=$(n.target.nextElementSibling);t.slideToggle();n.preventDefault()})},rt=function(n,t){let i=null;switch(n){case"Button":i=kt+t;break;case"InputNumber":i=l+t;break;case"InputText":i=l+t;break;case"SelectOption":i=ii+t;break;case"TextArea":i=ti+t;break;case"CheckBox":i=ni+t;break;case"RadioButton":i=gt+t;break;case"ColorBox":i=dt+t;break;case"DataGrid":i=ri+t}return i},li=function(n,t,i,r,u,f,e,o,s,h){h||(h={allowDeleting:!0,allowAdding:!0,confirmDelete:!0,texts:{confirmDeleteMessage:""}});let c={dataSource:{store:t},showColumnLines:!1,showRowLines:!0,height:"300px",showBorders:!0,dateSerializationFormat:"yyyy-MM-ddTHH:mm:ss",rowAlternationEnabled:!0,noDataText:yt,editing:h,onCellPrepared:function(n){r!=null&&r(n)},onRowInserting:async function(n){u!=null&&u(n)},onRowRemoving:async function(n){f!=null&&f(n)},onRowPrepared:function(n){e!=null&&e(n)},onRowUpdated:async function(n){o!=null&&o(n)},onEditorPreparing:function(n){s!=null&&s(n)}};i&&(c.columns=i);$("#"+n).dxDataGrid(c)},ut=function(n){let t=null;return(t=b(i,function(t){return t.Name==n}),t!=null&&t.length>0)?t[0]:undefined},n=function(n){let t=ut(n),i=null;if(t&&t!=null)switch(t.ControlType){case"Button":i=$(t.HtmlSelector).dxButton("instance");break;case"InputNumber":i=$(t.HtmlSelector).dxNumberBox("instance");break;case"InputText":case"InputHoursAndMinutes":i=$(t.HtmlSelector).dxTextBox("instance");break;case"SelectOption":i=$(t.HtmlSelector).dxSelectBox("instance");break;case"TextArea":i=$(t.HtmlSelector).dxTextArea("instance");break;case"CheckBox":i=$(t.HtmlSelector).dxCheckBox("instance");break;case"RadioButton":i=$(t.HtmlSelector).dxRadioGroup("instance");break;case"ColorBox":i=$(t.HtmlSelector).dxColorBox("instance");break;case"TagBox":i=$(t.HtmlSelector).dxTagBox("instance");break;case"DateBox":i=$(t.HtmlSelector).dxDateBox("instance");break;case"DataGrid":i=$(t.HtmlSelector).dxDataGrid("instance");break;case"FileManager":i=$(t.HtmlSelector).dxFileManager("instance")}return i},ai=function(t){let i=Object.keys(t);i.forEach(function(i){let u=$("[data-binding="+i+"]");if(u!=null){let f=n(u.attr("id"));if(f!=null){r[i]=t[i];let n=t[i];switch(vi(f)){case"CheckBox":case"DateBox":case"TagBox":n=n!=null?n:null;break;default:n=n!=null?n.toString():null}r[i]!=null&&(r[i]=r[i].toString());yi(n,f,u.attr("elementType"))}}})};let pi=function(n,t,r,u,f){a=u;typeof f=="undefined"&&(f="LivePortal");y("Base","LoadViewOptions","POST",{viewType:n,viewState:t,languageFile:f},null,function(n){n.forEach(function(n){let t=rt(n.ControlType,n.UniqueKey);ft(n.ControlType,n.UniqueKey,n.LabelText,n.Caption,n.Values,null,n.ElementAttr,n.DataGridColumnConfig,u);n.viewBindingAttr=$("#"+t).attr("data-binding");i.push(n)});r!=null&&r()},null,null)},wi=function(t,i){let r=n(t);if(r!=null){r.off("valueChanged");r.on("valueChanged",function(n){i!=null?i(n):a!=null&&a(n)})}},ft=function(n,t,i,r,f,e,o,s,h){let a=rt(n,t);switch(n){case"Button":$("#"+a).dxButton({elementAttr:{id:o!=null?o.Id:"","class":o!=null?o.ClassName:"",name:t},focusStateEnabled:!0,hoverStateEnabled:!0,icon:o!=null?o.Icon:"",template:"content",text:r,type:o!=null?o.Type:"default",useSubmitBehavior:!1,onValueChanged:function(n){h!=null&&h(n)}});break;case"InputNumber":$("#"+a).dxNumberBox({text:r,readOnly:!1,width:c+"px",placeholder:"",value:"",onValueChanged:function(n){h!=null&&h(n)}});break;case"InputText":$("#"+a).dxTextBox({text:r,readOnly:!1,width:c+"px",placeholder:"",value:"",onValueChanged:function(n){h!=null&&h(n)}});break;case"SelectOption":$("#"+a).dxSelectBox({items:f,value:e!=null?e:f!=null&&f.length>0?f[0].Id:null,valueExpr:"Value",displayExpr:"Text",width:pt+"px",onValueChanged:function(n){h!=null&&h(n)}});break;case"TextArea":$("#"+a).dxTextArea({value:"",width:wt+"px",height:90,onValueChanged:function(n){h!=null&&h(n)}});break;case"CheckBox":$("#"+a).dxCheckBox({text:r,hint:" ",valueExpr:"Value",height:25,onContentReady:function(){},onValueChanged:function(n){h!=null&&h(n)}});break;case"RadioButton":$("#"+a).dxRadioGroup({items:f,value:e!=null?e:f!=null&&f.length>0?f[0].Text:null,displayExpr:"Text",valueExpr:"Value",layout:"vertical",onValueChanged:function(n){h!=null&&h(n)}});break;case"ColorBox":$("#"+a).dxColorBox({value:r,width:bt+"px",height:30,onValueChanged:function(n){h!=null&&h(n)}});break;case"DataGrid":s&&(s.forEach(n=>n.visible=n.visible==null?!0:n.visible),$("#"+a).dxDataGrid({filterRow:{visible:!0},columns:s}));break;case"TagBox":$("#"+ui+t).dxTagBox({items:f,searchEnabled:!0,displayExpr:"Text",valueExpr:"Value"});break;case"DateBox":let i=$("#"+u+t).attr("date-type"),n=$("#"+u+t).attr("date-format"),v=$("#"+u+t).attr("date-displayformat"),y=$("#"+u+t).attr("date-pickerType");typeof i=="undefined"&&(i="time");typeof n=="undefined"&&(n="yyyy-MM-ddTHH:mm:ss");typeof v=="undefined"&&(v=n);typeof y=="undefined"&&(y="rollers");$("#"+u+t).dxDateBox({dateSerializationFormat:n,displayFormat:v,type:i,pickerType:y,defaultValue:r,elementAttr:{elementType:o!=null?o.Type:""}});break;case"InputHoursAndMinutes":$("#"+l+t).dxTextBox({text:r,readOnly:!1,width:c+"px",placeholder:"",value:"",mask:"00:00",maskChar:"_",useMaskedValue:!0,elementAttr:{elementType:o!=null?o.Type:""}});break;case"FileManager":$("#"+fi+t).dxFileManager({name:"fileManager",width:"100%",fileSystemProvider:[],permissions:{create:!1,"delete":!0,rename:!1,download:!0,upload:!0,move:!1,copy:!1},upload:{chunkSize:1e7,maxFileSize:1e7},itemView:{mode:"thumbnails",details:{columns:[{dataField:"thumbnail",caption:"Miniatura"},{dataField:"name",caption:"Nombre"},{dataField:"dateModified",caption:"Fecha",format:"shortDate"},{dataField:"size",caption:"TamaÃ±o"}]},showParentFolder:!1}})}$("#lb"+t).text(i)},p=function(){let t={};return i.forEach(function(i){if(i.viewBindingAttr!=undefined){let r=n(i.Name);r!=null&&(t[i.viewBindingAttr]=r.option("value"));t[i.viewBindingAttr]!=null&&(t[i.viewBindingAttr]=t[i.viewBindingAttr].toString())}}),t},et=function(){const n=Object.keys(p()).sort().reduce((n,t)=>(n[t]=p()[t],n),{}),t=Object.keys(r).sort().reduce((n,t)=>(n[t]=r[t],n),{});return JSON.stringify(t)!=JSON.stringify(n)},bi=function(){let n=!0;return i.forEach(function(t){ot(t)||(n=!1)}),n},ki=function(){i.forEach(function(t){w(t);let i=n(t.Name);i!=null&&i.option("isValid",!0)})},ot=function(t){let i=!0;if(t.HtmlSelector!=undefined&&t.HtmlSelector!=""){let r=$(t.HtmlSelector).data("validation");if(r){let u=n(t.Name);u!=null&&r==="required"&&(u.option("value")==""||u.option("value")==null?(i=!1,u.option("isValid",!1),st(t)):(u.option("isValid",!0),w(t)))}}return i},w=function(n){var t=$(`[data-validation-binding="${n.HtmlSelector}"]`);t!=undefined&&(t.addClass("d-none"),t.removeClass("d-block"))},st=function(t){var i=$(`[data-validation-binding="${t.HtmlSelector}"]`),r,u,f;i.length>0&&(r=i.data("validation-message"),r!=undefined&&(i.html(ht(r)),i.removeClass("d-none"),i.addClass("d-block")));u=n(t.Name);u!=null&&(f=ht($(t.HtmlSelector).data("validation-message")),u.option("validationError",{message:f}))},ht=function(n){var t="";if(n!=undefined){try{t=at(n)}catch(i){}return t}return""},di=function(n){tt=n;g=document.querySelector("#filterListBtn > nobr > span");$("#filterListBtn").off("click");$("#filterListBtn").on("click",nr)},gi=function(n){s=n},nr=async function(){f?($("#searchButtonDirection").addClass("fa-caret-right").removeClass("fa-caret-down"),$("#cardTreeSearchFilter").hide(),f=!1):(nt||await y("Base","GetCardViewSearchFilter","POST",{viewType:tt},null,function(n){nt=!0;o=n},null,null),o!=null&&($("#cardTreeSearchFilter").dxList({dataSource:o,height:function(){return $(window).height()*.6},itemTemplate:function(n){let t=$("<div>").html(n.Description);return n?.Parent!="1"&&$(t).css("padding-left","2rem"),t},onItemClick:function(n){tr(n.itemData);ct(!0)}}),$("#cardTreeSearchFilter").css("max-height",o.length*40+"px")),$("#searchButtonDirection").addClass("fa-caret-down").removeClass("fa-caret-right"),$("#cardTreeSearchFilter").show(),f=!0);ct()},tr=function(n){$("#cardTreeSearchFilter").hide();$("#searchButtonDirection").addClass("fa-caret-right").removeClass("fa-caret-down");f=!1;g.innerText=n.Description;ir(n)},ir=function(n){const t=n.Filter||"Filterfield";var i=n.ID==""?"":t+":"+n.ID;window.handleCardTreeCustomSearch("",i)},ct=function(){const n=$("#filterListBtn"),t=$("#filterInnerScope");f?(n.removeClass("reportTagsBtnActive"),t.removeClass("active"),n.find(".fa.fa-caret-down.fa-caret-downDroped").removeClass("fa-caret-downDroped")):(n.addClass("reportTagsBtnActive"),t.addClass("active"),n.find(".fa.fa-caret-down").addClass("fa-caret-downDroped"))},b=function(n,t){return $.grep(n,t)},rr=function(n){let i=$("#"+n).serializeArray(),t={};return $(i).each(function(n,i){t[i.name]=i.value}),t},ur=function(n){let i=et(),t=!1;switch(n){case"read":case"update":case"create":t=i}t===!0?$(d).addClass("active"):$(d).removeClass("active")},fr=function(){i.forEach(function(t){let i=n(t.Name);if(i!=null)try{i.reset()}catch{i.option("value",null)}})},er=function(n,t,i){return{captionKey:n,descriptionKey:t,callbackFunc:i}},or=function(n,t,i,r,u){let f={typeIcon:n,titleKey:i,descriptionKey:r,returnCode:t,buttons:u};v||(v=!0,sr(f,""))},sr=function(n,t,i){let r=window,u=function(){var r="",f=[],e="";if(n.descriptionKey!="")r=n.returnCode!=""?n.returnCode+": "+(n.descriptionKey!=""?_self.Globalize.formatMessage(n.descriptionKey):h):n.descriptionKey!=""?_self.Globalize.formatMessage(n.descriptionKey):h;else if(t==""&&typeof i!="undefined"){let n=JSON.parse(i);r=typeof n.errorTextField=="undefined"?n.ErrorText:n.errorTextField==null?"":n.errorTextField;n.ReturnCode!=""&&(r=(typeof n.returnCodeField=="undefined"?n.ReturnCode:n.returnCodeField==null?"":n.returnCodeField)+": "+r)}else r=t;e=n.titleKey!=""?_self.Globalize.formatMessage(n.titleKey):h;let u=$("<div>").attr("class","roPopupMsg");u.append($("<div>").attr("class","roPopupIcon ro-icon-errorType-"+n.iconType));u.append($("<div>").attr("class","roPopupText").html(r));let s=$("<div>").attr("style","clear:both");$.each(n.buttons,function(n,t){t.captionKey!=""&&f.push({text:t.captionKey!=""?_self.Globalize.formatMessage(t.captionKey):"",hint:t.descriptionKey!=""?_self.Globalize.formatMessage(t.descriptionKey):"",onClick:function(){return t.captionKey}})});let o=DevExpress.ui.dialog.custom({title:e,messageHtml:$("<div>").append(u,s).html(),css:"roCustomDialog",buttons:f});o.show().done(function(t){const i=b(n.buttons,function(n){return n.captionKey==t});i.length>0&&i[0].callbackFunc!=undefined&&i[0].callbackFunc!=null&&i[0].callbackFunc();v=!1;o.hide()})};typeof r.loadJSErrorLanguages=="function"&&r.loadJSErrorLanguages(u)};let t=function(n,t){document.dispatchEvent(new CustomEvent("startStateEvent",{detail:{currentState:n,event:t}}))},lt=function(n,t){const i={value:n.initialState,transition(t,r){const f=n[t],u=f.transitions[r];if(u){const e=u.target,o=n[e];return u.action(),f.actions.onExit(),o.actions.onEnter(),i.value=e,i.value}}};return t!=null&&t(),i},cr=function(){return lt({initialState:"read",read:{actions:{onEnter(){t("read","enter")},onExit(){t("read","exit")}},transitions:{create:{target:"create",action(){}},update:{target:"update",action(){}},"delete":{target:"delete",action(){}}}},create:{actions:{onEnter(){t("create","enter")},onExit(){t("create","exit")}},transitions:{read:{target:"read",action(){}}}},update:{actions:{onEnter(){t("update","enter")},onExit(){t("update","exit")}},transitions:{read:{target:"read",action(){}}}},"delete":{actions:{onEnter(){t("delete","enter")},onExit(){t("delete","exit")}},transitions:{read:{target:"read",action(){}}}}})},at=function(n){try{return parent.Globalize.formatMessage(n)}catch{return""}};return{setupCardListFilterButton:di,oldTab:function(){return e},changeTab:hr,getCurrentModelData:p,filterInArray:b,formHasChanged:et,onValueChangedEvent:wi,getFormObject:rr,setToolbarButtonsState:ur,makeServiceCall:y,makeServiceCallText:ei,getHtmlControl:n,buildHtmlControl:ft,loadViewOptions:pi,viewStateHandler:lt,createViewStateHandler:cr,buildDataGrid:li,viewBinding:ai,getSelectedCardId:oi,getSelectedCardIsSystem:si,setSelectedCardId:hi,resetHtmlControls:fr,initAccordions:ci,showModalDialog:or,buildButtonDialog:er,DXTranslate:at,validateForm:bi,clearValidationForm:ki,validateItem:ot,getItemControl:ut,hideValidationMessage:w,showValidationMessage:st,setBarButtonCallback:gi,print:function(){}}}();