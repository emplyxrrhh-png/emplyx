function openConfigurationHelp(n){return function(){switch(n){case"adfs":$("#adfsHelp").dxPopup("instance").show();break;case"aad":$("#aadHelp").dxPopup("instance").show();break;case"okta":$("#oktaHelp").dxPopup("instance").show()}}}function checkEnableSave(n){$("#btSubmitNewConfiguration").dxButton("instance").option("disabled",!n.value)}function checkSSOStatus(n){$("#rgSSOptions").dxList("instance").option("disabled",!n.value);$("#ckVPortalMixAuthEnabled").dxCheckBox("instance").option("disabled",!n.value);$("#ckVTLiveMixAuthEnabled").dxCheckBox("instance").option("disabled",!n.value)}function ssoValueChanged(n){$("#federationMetadataURL").dxTextBox("instance").option("disabled",!0);$("#wsRealm").dxTextBox("instance").option("disabled",!0);$("#aadClientID").dxTextBox("instance").option("disabled",!0);$("#aadTenantID").dxTextBox("instance").option("disabled",!0);$("#oktaClientID").dxTextBox("instance").option("disabled",!0);$("#oktaSecret").dxTextBox("instance").option("disabled",!0);$("#oktaAuthority").dxTextBox("instance").option("disabled",!0);$("#samlMetadataURL").dxTextBox("instance").option("disabled",!0);$("#samlIpID").dxTextBox("instance").option("disabled",!0);$("#samlSigningBehaviour").dxSelectBox("instance").option("disabled",!0);switch(n.addedItems[0].toLowerCase()){case"adfs":$("#federationMetadataURL").dxTextBox("instance").option("disabled",!1);$("#wsRealm").dxTextBox("instance").option("disabled",!1);$("#federationMetadataURL").dxTextBox("instance").focus();break;case"aad":$("#aadClientID").dxTextBox("instance").option("disabled",!1);$("#aadTenantID").dxTextBox("instance").option("disabled",!1);$("#aadClientID").dxTextBox("instance").focus();break;case"okta":$("#oktaClientID").dxTextBox("instance").option("disabled",!1);$("#oktaSecret").dxTextBox("instance").option("disabled",!1);$("#oktaAuthority").dxTextBox("instance").option("disabled",!1);$("#oktaClientID").dxTextBox("instance").focus();break;case"saml":$("#samlMetadataURL").dxTextBox("instance").option("disabled",!1);$("#samlIpID").dxTextBox("instance").option("disabled",!1);$("#samlSigningBehaviour").dxSelectBox("instance").option("disabled",!1);$("#samlMetadataURL").dxTextBox("instance").focus()}}function ssoItemTemplate(n,t,i){let r=null;switch(n.toLowerCase()){case"cegidid":r=$("<div style='padding-top:15px'>").append($("<div>").append($('<div style="float:left">').append($("<span class='ssoTitle'>").text("cegidID")),$('<div style="float:left">').append($("<span style='margin-left:15px'>").text(jsLabels["SSO#cegidInformation"]))));break;case"adfs":r=$("<div>").append($("<div>").append($('<div style="float:left">').append($("<span class='ssoTitle'>").text(n)),$('<div style="float:left">').append($("<span style='margin-left:15px'>").text(jsLabels["SSO#adfsInformation"])),$('<div style="float:left">').append($("<span>").text("[...]").on("click",openConfigurationHelp("adfs")))),$('<div style="clear:both" class="dx-fieldset ssoOption">').append($('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#adfsmetadataURL"]),$('<div id="federationMetadataURL">').dxTextBox({width:"500px"})),$('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#adfsRealm"]),$('<div id="wsRealm">').dxTextBox({width:"500px"}))));break;case"aad":r=$("<div>").append($("<div>").append($('<div style="float:left">').append($("<span class='ssoTitle'>").text(n)),$('<div style="float:left">').append($("<span style='margin-left:15px'>").text(jsLabels["SSO#aadInformation"])),$('<div style="float:left">').append($("<span>").text("[...]").on("click",openConfigurationHelp("aad")))),$('<div style="clear:both" class="dx-fieldset ssoOption">').append($('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#aadClient"]),$('<div id="aadClientID">').dxTextBox({width:"500px"})),$('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#aadTenant"]),$('<div id="aadTenantID">').dxTextBox({width:"500px"}))));break;case"okta":r=$("<div>").append($("<div>").append($('<div style="float:left">').append($("<span class='ssoTitle'>").text(n)),$('<div style="float:left">').append($("<span style='margin-left:15px'>").text(jsLabels["SSO#oktaInformation"])),$('<div style="float:left">').append($("<span>").text("[...]").on("click",openConfigurationHelp("okta")))),$('<div style="clear:both" class="dx-fieldset ssoOption">').append($('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#oktaClient"]),$('<div id="oktaClientID">').dxTextBox({width:"500px"})),$('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#oktaSecret"]),$('<div id="oktaSecret">').dxTextBox({width:"500px"})),$('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#oktaAuthority"]),$('<div id="oktaAuthority">').dxTextBox({width:"500px"}))));break;case"saml":r=$("<div>").append($("<div>").append($('<div style="float:left">').append($("<span class='ssoTitle'>").text(n)),$('<div style="float:left">').append($("<span style='margin-left:15px'>").text(jsLabels["SSO#samlInformation"]))),$('<div style="clear:both" class="dx-fieldset ssoOption">').append($('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#metadataURL"]),$('<div id="samlMetadataURL">').dxTextBox({width:"500px"})),$('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#ipID"]),$('<div id="samlIpID">').dxTextBox({width:"500px"})),$('<div class="dx-field">').append($("<span>").text(jsLabels["SSO#signingBehaviour"]),$('<div id="samlSigningBehaviour">').dxSelectBox({width:"500px",displayExpr:"Name",valueExpr:"ID",dataSource:[{ID:"Never",Name:jsLabels["SSO#never"]},{ID:"IfIdpWantAuthnRequestsSigned",Name:jsLabels["SSO#idp"]},{ID:"Always",Name:jsLabels["SSO#always"]}]}))))}i.append(r)}function saveSSOData(){saveData()}var currentConfig=null;(function(){function i(n){var t=n.detail;viewUtilsManager.print(t.currentState+" state");switch(t.currentState){}}function r(n){currentConfig=n;$("#federationMetadataURL").dxTextBox("instance").option("value",n.Adfs.FedartionURL);$("#wsRealm").dxTextBox("instance").option("value",n.Adfs.FederationRealm);$("#aadClientID").dxTextBox("instance").option("value",n.AAD.ClientID);$("#aadTenantID").dxTextBox("instance").option("value",n.AAD.TenantID);$("#oktaClientID").dxTextBox("instance").option("value",n.Okta.ClientId);$("#oktaSecret").dxTextBox("instance").option("value",n.Okta.ClientSecret);$("#oktaAuthority").dxTextBox("instance").option("value",n.Okta.Authority);$("#samlMetadataURL").dxTextBox("instance").option("value",n.SAML.MetadataURL);$("#samlIpID").dxTextBox("instance").option("value",n.SAML.IdentityProviderID);$("#samlSigningBehaviour").dxSelectBox("instance").option("value",n.SAML.SigningBehaviour==""?"IfIdpWantAuthnRequestsSigned":n.SAML.SigningBehaviour);$("#ckSSOStatus").dxCheckBox("instance").option("value",n.Active);$("#ckVTLiveMixAuthEnabled").dxCheckBox("instance").option("value",n.VTLiveMixAuthEnabled);$("#ckVPortalMixAuthEnabled").dxCheckBox("instance").option("value",n.VTPortalMixAuthEnabled);switch(n.SSOType){case 1:$("#rgSSOptions").dxList("instance").selectItem(0);break;case 2:$("#rgSSOptions").dxList("instance").selectItem(2);break;case 3:$("#rgSSOptions").dxList("instance").selectItem(1);break;case 4:$("#rgSSOptions").dxList("instance").selectItem(3);break;case 5:$("#rgSSOptions").dxList("instance").selectItem(4)}}function u(){var n={...currentConfig},t,i;if(n.Adfs.FedartionURL=$("#federationMetadataURL").dxTextBox("instance").option("value"),n.Adfs.FederationRealm=$("#wsRealm").dxTextBox("instance").option("value"),n.AAD.ClientID=$("#aadClientID").dxTextBox("instance").option("value"),n.AAD.TenantID=$("#aadTenantID").dxTextBox("instance").option("value"),n.Okta.ClientId=$("#oktaClientID").dxTextBox("instance").option("value"),n.Okta.ClientSecret=$("#oktaSecret").dxTextBox("instance").option("value"),n.Okta.Authority=$("#oktaAuthority").dxTextBox("instance").option("value"),n.SAML.MetadataURL=$("#samlMetadataURL").dxTextBox("instance").option("value"),n.SAML.IdentityProviderID=$("#samlIpID").dxTextBox("instance").option("value"),n.SAML.SigningBehaviour=$("#samlSigningBehaviour").dxSelectBox("instance").option("value"),n.Active=$("#ckSSOStatus").dxCheckBox("instance").option("value"),n.VTLiveMixAuthEnabled=$("#ckVTLiveMixAuthEnabled").dxCheckBox("instance").option("value"),n.VTPortalMixAuthEnabled=$("#ckVPortalMixAuthEnabled").dxCheckBox("instance").option("value"),t=$("#rgSSOptions").dxList("instance").option("selectedItems"),t.length>0){i=t[0];switch(i.toLowerCase()){case"cegidid":n.SSOType="cegidId";break;case"aad":n.SSOType="AAD";break;case"adfs":n.SSOType="Adfs";break;case"okta":n.SSOType="Okta";break;case"saml":n.SSOType="SAML"}}return n}var n=null;$(document).ready(async function(){viewUtilsManager.initAccordions();viewUtilsManager.setupCardListFilterButton("SSO");viewUtilsManager.print("SSO Module loaded");n=viewUtilsManager.createViewStateHandler();window.loadRequest=t;window.saveData=f;document.addEventListener("startStateEvent",n=>i(n),!1);n.transition(n.value,"read");viewUtilsManager.loadViewOptions("SSO","read",function(){$("#btSubmitNewConfiguration").dxButton("instance").option("disabled",!1);t()},()=>{},"LiveSecurity")});const t=()=>{viewUtilsManager.makeServiceCall("SSO","GetSSOConfiguration","POST",{},null,function(n){n!=null?r(n):DevExpress.ui.notify(viewUtilsManager.DXTranslate("roPermissionsError"),"error",2e3)},null,null)};const f=()=>{viewUtilsManager.makeServiceCall("SSO","SaveSSOConfiguration","POST",{oConf:u()},null,function(n){n?DevExpress.ui.dialog.alert(viewUtilsManager.DXTranslate("roSSOConfigSavedMT"),"Info"):DevExpress.ui.dialog.alert(viewUtilsManager.DXTranslate("roSSOSaveError"),"Error")},null,null)}})();