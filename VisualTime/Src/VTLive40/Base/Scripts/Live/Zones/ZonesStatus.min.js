function getWidth(){return document.documentElement.clientWidth-40}function getHeight(){return document.documentElement.clientHeight-40}function selection_changed(n){if(n.columnIndex==0){var t=n.row.data.IdEmployee;return window.open("../#/"+RootUrl+"/Employees/Employees?IDEmployee="+t,"_blank"),!1}}function updateComboValue(n){$("#ZonesList").dxSelectBox("instance").getDataSource().load().done(function(t){for(i=0;i<t.length;i++)if(t[i].ID==n){$("#ZonesList").dxSelectBox("instance").option("value",t[i]);return}})}function refreshGrid(n){var t;if(n.value!=null){localStorage.setItem("zoneSelected",$("#ZonesList").dxSelectBox("instance").option("value").ID);try{$("#gridStatusEmployees").dxDataGrid("instance").refresh();$("#gridStatusEmployeesLastHour").dxDataGrid("instance").refresh()}catch(f){}if(n.value.GoogleMapInfo!=null){t=(n.value.GoogleMapInfo.Coordinates[0].Latitud+n.value.GoogleMapInfo.Coordinates[1].Latitud)/2+","+(n.value.GoogleMapInfo.Coordinates[0].Longitud+n.value.GoogleMapInfo.Coordinates[1].Longitud)/2;localStorage.setItem("zoneSelectedCoords",t);var i=$("#globalMap").dxMap("instance"),r=i.option("markers"),u=$.map(r,function(n){return n.location==t?$.extend(!0,{},n,{tooltip:{isShown:!0}}):$.extend(!0,{},n,{tooltip:{isShown:!1}})});i.option("markers",u)}}}function selectFirstMarker(n){var t=localStorage.getItem("zoneSelectedCoords");t==n.options.location&&(n.options.tooltip.isShown=!0)}function onContentReady(n){var t=localStorage.getItem("zoneSelected");firstRender&&n.component.getDataSource().load().done(function(r){if(t!=null&&t!="undefined"&&t!="null"&&t!=""){for(i=0;i<r.length;i++)if(r[i].ID==t){n.component.option("value",r[i]);return}}else if(t==null||t==""){n.component.option("value",r[0]);return}});firstRender=!1}function initializeGlobalMap(n){globalMap=n.originalMap;$("#globalMap").dxMap({center:ZonaGlobal.MaxLatitude+","+ZonaGlobal.MaxLongitud});const t=$("#globalMap").dxMap("instance");Zones.forEach(n=>{n.GoogleMapInfo!=null&&(n.CurrentPeopleIn>0||n.CurrentPeopleOut>0?t.addMarker({iconSrc:"Base/Images/markerColorMedium.png",location:(n.GoogleMapInfo.Coordinates[0].Latitud+n.GoogleMapInfo.Coordinates[1].Latitud)/2+","+(n.GoogleMapInfo.Coordinates[0].Longitud+n.GoogleMapInfo.Coordinates[1].Longitud)/2,tooltip:{isShown:!0,text:"<strong><div>"+n.Name+"<\/div><\/strong><br><div>"+n.CurrentPeopleInDesc+"<\/div><br><div>"+n.CurrentPeopleOutDesc+"<\/div><br><i><div>"+n.CapacityDesc+"<\/div><\/i>"},onClick:function(){updateComboValue(n.ID)}}):t.addMarker({iconSrc:"Base/Images/markerGreyMedium.png",location:(n.GoogleMapInfo.Coordinates[0].Latitud+n.GoogleMapInfo.Coordinates[1].Latitud)/2+","+(n.GoogleMapInfo.Coordinates[0].Longitud+n.GoogleMapInfo.Coordinates[1].Longitud)/2,tooltip:{isShown:!1,text:"<strong><div>"+n.Name+"<\/div><\/strong><br><div>"+n.CurrentPeopleInDesc+"<\/div><br><div>"+n.CurrentPeopleOutDesc+"<\/div><br><i><div>"+n.CapacityDesc+"<\/div><\/i>"},onClick:function(){updateComboValue(n.ID)}}))})}function updateGlobalMap(n){var i,r,t;for(dynamicZoomBounds=[],deleteAllShape(),t=0;t<n.length;t++)i=n[t].GoogleMapInfo,i!=null&&globalMap!=null&&(globalMap.setCenter(new google.maps.LatLng(i.Center.Latitud.toString(),i.Center.Longitud.toString())),globalMap.setZoom(i.Zoom),i.Coordinates.length>0&&(i.Shape==_RECTANGLE_SHAPE?drawGlobalMapRectZone(i,n[t].Color):i.Shape==_POLYGON_SHAPE&&drawGlobalMapPolyZone(i,n[t].Color)));for(r=new google.maps.LatLngBounds,t=0;t<dynamicZoomBounds.length;t++)r.extend(dynamicZoomBounds[t]);dynamicZoomBounds.length>0&&globalMap.fitBounds(r)}function beforeSend(n,t){$("#ZonesList").dxSelectBox("instance").option("value")!=null&&$("#ZonesList").dxSelectBox("instance").option("value").ID>0&&(t.method="POST",t.data.idZone=localStorage.getItem("zoneSelected"))}function beforeSendLastHour(n,t){$("#ZonesList").dxSelectBox("instance").option("value")!=null&&$("#ZonesList").dxSelectBox("instance").option("value").ID>0&&(t.method="POST",t.data.idZone=localStorage.getItem("zoneSelected"))}function hasData(){return!1}function cell_prepared(n){var i,t;if(n.columnIndex==0&&typeof n.row!="undefined")if(n.row.data.PresenceStatus=="In")n.cellElement.addClass("employeeListPhoto");else if(n.row.data.LastPunchFormattedDateTime!="")n.cellElement.addClass("employeeListPhotoOut");else for(n.cellElement.addClass("employeeListNA"),i=n.row.cells.length,t=0;t<i;t++)typeof n.row.cells[t].cellElement!="undefined"&&n.row.cells[t].cellElement.addClass("naUser")}var drawedMainMapRectangle,drawedMainMapPolygon,globalMap,allzones=[],isFirstShape,dynamicZoomBounds=[],firstLoad=!0,firstRender,headerFilter,headerFilterTelecommute;const _RECTANGLE_SHAPE="rectangle",_POLYGON_SHAPE="polygon";firstRender=!0;headerFilter={load:function(){return[{text:viewUtilsManager.DXTranslate("roPresent"),value:[["PresenceStatus","=","In"]]},{text:viewUtilsManager.DXTranslate("roAbsent"),value:[["PresenceStatus","<>","In"]]}]}};headerFilterTelecommute={load:function(){return[{text:viewUtilsManager.DXTranslate("roHome"),value:[["InTelecommute","=",!0]]},{text:viewUtilsManager.DXTranslate("roOffice"),value:[["InTelecommute","=",!1]]}]}};