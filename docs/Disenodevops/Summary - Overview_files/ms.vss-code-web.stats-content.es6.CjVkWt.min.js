"use strict";define("VC/Stats",["require","exports","react","VSSUI/Icon","VSSUI/Util","VSS/Core/Util/String","VSS/Platform/Layout"],(function(e,t,s,o,a,n,c){var r,i;r=t[i="Resources"]={},t[i].LanguagesHeaderText="Languages",t[i].ProjectLanguage_ItemNameAriaLabel="{0} Language {1} percent",t[i].ProjectLanguages_AriaLabel="Project Languages",t[i].CommitsAndChangeSets="Commits and Changesets by {0} authors",t[i].ChangeSetsByAuthorsString="Changesets by {0} authors",t[i].CommitsByAuthorsString="Commits by {0} authors",t[i].PullRequestsOpened="Pull requests opened",t[i].MoreThan10K="10K+",function(e){t[e]={};class i extends c.VssComponent{constructor(e,t){super(e,t);const s=t.pageContext.getService("IVssContributionService").getContribution("ms.vss-code-web.code-service-navigation-info");s&&(this._serviceName=s.name),this.state={}}componentDidMount(){super.componentDidMount(),this._fetchCodeMetrics(this.props.numOfDays)}componentDidUpdate(e,t){super.componentDidUpdate(e,t),e.numOfDays!==this.props.numOfDays&&this._fetchCodeMetrics(this.props.numOfDays)}render(){return s.createElement("div",{className:(0,a.css)(this.props.className,"code-metric-tile")},(this.state.gitmetrics||this.state.tfvcmetrics)&&this._serviceName?s.createElement(m,{metricData:this.state,title:this._serviceName}):null)}_fetchCodeMetrics(e){const t=this.context.pageContext.getService("IVssPerformanceService"),s={numOfDays:e};t.startScenario("FetchCodeMetrics",!1),this.trackPromise(this.context.pageContext.getService("IVssContributionService").getDataAsync("ms.vss-code-web.code-metrics-data-provider-verticals",s)).promise.then((e=>{e?(t.endScenario("CodeMetricsSection","FetchCodeMetrics",!1),this.setState(e)):this._endPerfScenario(t)}),(()=>{this._endPerfScenario(t)}))}_endPerfScenario(e){e.endScenario("CodeMetricsSection","FetchCodeMetrics",!1,void 0,{status:"failed"})}}t[e].CodeMetricsSection=i;const m=e=>{const{tfvcmetrics:t,gitmetrics:o}=e.metricData;let a,c=0;if(t&&o){c=t.changesets+o.commitsPushedCount;const e=o.authorsCount+t.authors;a=(0,n.format)(r.CommitsAndChangeSets,e)}else t?(c=t.changesets,a=(0,n.format)(r.ChangeSetsByAuthorsString,t.authors)):o&&(c=o.commitsPushedCount,a=(0,n.format)(r.CommitsByAuthorsString,o.authorsCount));return s.createElement(s.Fragment,null,s.createElement("div",{className:"body-l"},e.title),s.createElement("div",{className:"code-stats flex-row"},o&&d("pull-request-created code-stats-component","BranchMerge",o.pullRequestsCreatedCount,r.PullRequestsOpened),d("commits-and-changesets code-stats-component","BranchCommit",c,a)))},d=(e,t,n,c)=>s.createElement("div",{className:(0,a.css)(e,"flex-row flex-grow")},s.createElement(o.Icon,{iconName:t,className:"code-icon body-l"}),s.createElement("div",{className:"count-and-text"},s.createElement("div",{className:"title-xs"}," ",n>1e4?r.MoreThan10K:n," "),s.createElement("div",{className:"text body-s word-break"},c)));c.Components.add("VC.CodeStats",i)}("CodeMetricsSection")}),["Resources","CodeMetricsSection"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-code-web.stats-content"}}));